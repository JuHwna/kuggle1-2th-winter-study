# Chapter 9. 추천시스템
## 1. 추천 시스템의 개요와 배경
### 추천 시스템의 개요
- 지금은 추천 시스템 전성시대
  - 콘텐츠 포털까지 추천 시스템을 통해 사용자의 취향을 이해하고 맞춤 상품과 콘텐츠를 제공해 조금이라도 오래 자기 사이트에 고객을 머무르게 하기 위해 전력을 기울이고 있음
  - 발전하는 추천 엔진으로 인해 더욱 더 많은 수익을 올릴 수 있다는 사실을 알고 있는 주요 업체들은 추천 엔진의 고도화에 큰 비용과 노력을 들이고 있음
- 하나의 콘텐츠를 선택했을 때 선택된 콘텐츠와 연관된 추천 콘텐츠가 얼마나 사용자의 관심을 끌고 개인에게 맞춘 콘텐츠를 추천했는지는 그 사이트의 평판을 좌우하는데 매우 중요한 요소
- 추천 시스템의 진정한 묘미 : 사용자 자신도 좋아하는지 몰랐던 취향을 시스템이 발견하고 그에 맞는 콘텐츨르 추천해주는 것

### 온라인 스토어의 필수 요소, 추천 시스템
- 추천 시스템은 특히 온라인에서 그 진가를 발휘함
- 좋은 추천 시스템 : 사용자가 무엇을 원하는지 빠르게 찾아내 사용자의 온라인 쇼핑의 즐거움을 배가함
  - 온라인 스토어에서 추천 시스템은 필수 구성 요소
- 온라인 스토어는 많은 양의 고객과 상품 관련 데이터를 가지고 있음
  - 이 모든 데이터가 사용자가 흥미를 가질 만한 상품을 즉각적으로 추천하는 데 사용됨
    - 사용자가 어떤 상품을 구매했는가?
    - 사용자가 어떤 상품을 둘러보거나 장바구니에 넣었는가?
    - 사용자가 평가한 영화 평점은? 제품 평가는?
    - 사용자가 스스로 작성한 자신의 취향은?
    - 사용자가 무엇을 클릭했는가?
    
### 추천 시스템의 유형
- 추천 시스템의 유형 
  - 콘텐츠 기반 필터링
  - 협업 필터링 방식
    - 최근접 이웃 협업 필터링
    - 잠재 요인 협업 필터링
- 추천 시스템의 초창기에는 콘텐츠 기반 필터링이나 최근접 이웃 기반 협업 필터링이 주로 사용됨
  - 넷플릭스 추천 시스템 경연 대회에서 행렬 분해 기법을 이용한 잠재 요인 협업 필터링 방식이 우승하면서 대부분의 온라인 스토어에서 잠재 요인 협업 필터링 기반의 추천 시스템을 적용
  - 하지만 서비스하는 아이템의 특성에 따라 콘텐츠나 최근접 이웃 기반 협업 필터링을 사용하기도 함
  - 요즘에는 개인화 특성을 좀 더 강화하기 위해서 하이브리드 형식으로 콘텐츠 기반과 협업 기반을 결합해 사용하는 경우도 늘고 있음
  
## 2. 콘텐츠 기반 필터링 추천 시스템
- 콘텐츠 기반 필터링 방식 : 사용자가 특정한 아이템을 매우 선호하는 경우, 그 아이템과 비슷한 콘텐츠를 가진 다른 아이템을 추천하는 방식
  - ex)사용자가 높게 평가한 영화의 콘텐츠를 감안해 이와 적절하게 매칭되는 영화를 추천해줌
  
## 3. 최근접 이웃 협업 필터링
- 협업 필터링 : 친구들에게 물어보는 것과 유사한 방식으로 사용자가 아이템에 매긴 평점 정보나 상품 구매 이력과 같은 사용자 행동 양식만을 기반으로 추천을 수행하는 것
- 협업 필터링의 주요 목표 : 사용자-아이템 평점 매트릭스와 같은 축적된 사용자 행동 데이터를 기반으로 사용자가 아직 평가하지 않은 아이템을 예측 평가하는 것

![image](https://user-images.githubusercontent.com/49123169/77330440-b63e9a00-6d62-11ea-92e1-c292c31531d9.png)

  - 협업 필터링은 사용자가 평가한 다른 아이템을 기반으로 사용자가 평가하지 않은 아이템의 예측 평가를 도출하는 방식
- 형법 필터링 기반의 추천 시스템은 최근접 이웃 방식과 잠재 요인 방식으로 나뉘며 두 방식 모두 사용자-아이템 평점 행렬 데이터에만 의지해 추천을 수행함
  - 협업 필터링 알고리즘에 사용되는 사용자-아이템 평점 행렬에서 행은 개별 사용자, 열은 개별 아이템으로 구성되며 사용자 아이디 행, 아이템 아이디 열 위치에 해당하는 값이 평점을 나타내는 형태가 돼야 함
  - 판다의 pivot_table()과 같은 함수를 이용해 사용자-아이템 평점 행렬 형태로 변경해야 함
  
![image](https://user-images.githubusercontent.com/49123169/77331971-c8b9d300-6d64-11ea-8a47-9708252da870.png)

- 일반적으로 이러한 사용자-아이템 평점 행렬은 많은 아이템을 열로 가지는 다차원 행렬이며 사용자가 아이템에 대한 평점을 매기는 경우가 많지 않기 때문에 희소 행렬 특성을 가지고 있음

- 최근접 이웃 협업 필터링(=메모리 협업 필터링)
  - 사용자 기반(User-User) : 당신과 비슷한 고객들이 다음 상품도 구매했습니다.
    - 사용자 기반 최근접 이웃 방식은 특정 사용자와 유사한 다른 사용자를 TOP-N으로 선정해 이 TOP-N 사용자가 좋아하는 아이템을 추천하는 방식
    - 즉, 특정 사용자와 타 사용자 같의 유사도를 측정한 뒤 가장 유사도가 높은 TOP-N 사용자를 추출해 그들이 선호하는 아이템을 추천하는 것
  - 아이템 기반(Item-Item) : 이 상품을 선택한 다른 고객들은 다음 상품도 구매했습니다.
    - 아이템 기반 최근접 이웃 방식 : 그 명칭이 주는 이미지 때문에 '아이템 간의 속성'이 얼마나 비슷한지를 기반으로 추천하다고 착각할 수 있음
    - 하지만 아이템이 가지는 속성과는 상관없이 사용자들이 그 아이템을 좋아하는지/싫어하는지의 평가 척도가 유사한 아이템을 추천하는 기준이 되는 알고리즘
    - 사용자 기반 최근접 이웃 데이터 세트와 행과 열이 서로 반대(행이 개별 아이템이고 열이 개별 사용자임)
    
- 일반적으로 사용자 기반보다는 아이템 기반 협업 필터링이 정확도가 더 높음
  - 이유 : 비슷한 영를 좋아한다고 해서 사람들의 취향이 비슷하다고 판단하기가 어려운 경우가 많음
  - 그래서 최근접 이웃 협업 필터링은 대부분 아이템 기반의 알고리즘을 적용함
- 코사인 유사도는 추천 시스템의 유사도 측정에 가장 많이 적용됨
  - 추천 시스템에 사용되는 데이터는 다차원 희소 행렬이라는 특징이 있으므로 유사도 측정을 위해 주로 코사인 유사도를 이용함
  
## 4. 잠재 요인 협업 필터링
### 잠재 요인 협업 필터링의 이해

  
